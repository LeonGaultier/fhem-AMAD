<?xml version='1.0' encoding='UTF-8' standalone='yes' ?>
<data version="1.28.0">
  <trigger type="http_request">
    <useDefaultName>true</useDefaultName>
    <name>HTTP Request: /automagic/deviceInfo, Port 8089</name>
    <enabled>true</enabled>
    <path>/automagic/deviceInfo</path>
    <port>8089</port>
    <acquireWifiLock>true</acquireWifiLock>
  </trigger>
  <condition type="battery_level">
    <useDefaultName>true</useDefaultName>
    <name>Akku Ladestand: grösser als 0%</name>
    <levelPercentage>0</levelPercentage>
    <batteryLevelCondition>HIGHER_THAN</batteryLevelCondition>
  </condition>
  <action type="write_http_response_text">
    <useDefaultName>false</useDefaultName>
    <name>HTTP Response</name>
    <text>powerLevel {battery_percentage}@@powerPlugged {battery_plugged}@@volumeMusikSpeaker {volumeMusikSpeaker}@@networkCountryIso {network_country_iso}@@voiceMailNumber {voice_mail_number}@@screenBrightness {screenBrightness}@@nextAlarmDay {next_alarmday}@@nextAlarmTime {next_alarmtime}</text>
    <replaceVariables>true</replaceVariables>
    <contentType>text/html</contentType>
  </action>
  <action type="init_variable_next_alarm">
    <useDefaultName>true</useDefaultName>
    <name>Initialisiere Variable Nächster Alarm: Variable next_alarm</name>
    <variable>next_alarm</variable>
  </action>
  <action type="init_variable_system_setting">
    <useDefaultName>true</useDefaultName>
    <name>Initialisiere Variable Systemeinstellung: System screen_brightness to screenBrightness</name>
    <settingCategory>SYSTEM</settingCategory>
    <settingName>screen_brightness</settingName>
    <variable>screenBrightness</variable>
  </action>
  <action type="init_variable_system_setting">
    <useDefaultName>true</useDefaultName>
    <name>Initialisiere Variable Systemeinstellung: System volume_music_speaker to volumeMusikSpeaker</name>
    <settingCategory>SYSTEM</settingCategory>
    <settingName>volume_music_speaker</settingName>
    <variable>volumeMusikSpeaker</variable>
  </action>
  <action type="init_variables_phone_info">
    <useDefaultName>true</useDefaultName>
    <name>Initialisiere Variablen Telefoninfo: network_country_iso, voice_mail_number</name>
    <isVariableNetworkCountryIso>true</isVariableNetworkCountryIso>
    <variableNetworkCountryIso>network_country_iso</variableNetworkCountryIso>
    <isVariableVoiceMailNumber>true</isVariableVoiceMailNumber>
    <variableVoiceMailNumber>voice_mail_number</variableVoiceMailNumber>
  </action>
  <action type="sleep">
    <useDefaultName>true</useDefaultName>
    <name>Pause: 2s (Gerät wach halten)</name>
    <duration>2s</duration>
    <keepDeviceAwake>true</keepDeviceAwake>
  </action>
  <action type="script">
    <useDefaultName>true</useDefaultName>
    <name>Script: next_alarmday = "{next_alarm,dateformat,c}"</name>
    <script>next_alarmday = "{next_alarm,dateformat,c}"</script>
  </action>
  <action type="script">
    <useDefaultName>true</useDefaultName>
    <name>Script: next_alarmtime = "{next_alarm,dateformat,HH:mm}"</name>
    <script>next_alarmtime = "{next_alarm,dateformat,HH:mm}"</script>
  </action>
  <flow type="flow">
    <name>Informationen</name>
    <group>FHEM Info / Steuerung über AMAD Modul</group>
    <enabled>true</enabled>
    <executionPolicy>PARALLEL</executionPolicy>
    <conditioncontainer id="t1" x="70.0" y="402.5">Akku Ladestand: grösser als 0%</conditioncontainer>
    <actioncontainer id="t2" x="525.0" y="647.5">Initialisiere Variable Nächster Alarm: Variable next_alarm</actioncontainer>
    <actioncontainer id="t3" x="70.0" y="1172.5">HTTP Response</actioncontainer>
    <actioncontainer id="t4" x="-140.0" y="647.5">Initialisiere Variablen Telefoninfo: network_country_iso, voice_mail_number</actioncontainer>
    <actioncontainer id="t5" x="70.0" y="647.5">Initialisiere Variable Systemeinstellung: System volume_music_speaker to volumeMusikSpeaker</actioncontainer>
    <actioncontainer id="t6" x="280.0" y="647.5">Initialisiere Variable Systemeinstellung: System screen_brightness to screenBrightness</actioncontainer>
    <actioncontainer id="t7" x="420.0" y="857.5">Script: next_alarmtime = "{next_alarm,dateformat,HH:mm}"</actioncontainer>
    <actioncontainer id="t8" x="630.0" y="857.5">Script: next_alarmday = "{next_alarm,dateformat,c}"</actioncontainer>
    <actioncontainer id="t9" x="69.999954" y="157.5001">Pause: 2s (Gerät wach halten)</actioncontainer>
    <triggercontainer id="t10" x="70.00001" y="-87.5">
      <trigger>HTTP Request: /automagic/deviceInfo, Port 8089</trigger>
    </triggercontainer>
    <connection from="t1" to="t5" type="TRUE" sourcePosition="SOUTH" targetPosition="NORTH" />
    <connection from="t1" to="t4" type="TRUE" sourcePosition="SOUTH" targetPosition="NORTH" />
    <connection from="t1" to="t6" type="TRUE" sourcePosition="SOUTH" targetPosition="NORTH" />
    <connection from="t1" to="t2" type="TRUE" sourcePosition="SOUTH" targetPosition="NORTH" />
    <connection from="t2" to="t7" type="NORMAL" sourcePosition="SOUTH" targetPosition="NORTH" />
    <connection from="t2" to="t8" type="NORMAL" sourcePosition="SOUTH" targetPosition="NORTH" />
    <connection from="t4" to="t3" type="NORMAL" sourcePosition="SOUTH" targetPosition="NORTH" />
    <connection from="t5" to="t3" type="NORMAL" sourcePosition="SOUTH" targetPosition="NORTH" />
    <connection from="t6" to="t3" type="NORMAL" sourcePosition="SOUTH" targetPosition="NORTH" />
    <connection from="t7" to="t3" type="NORMAL" sourcePosition="SOUTH" targetPosition="NORTH" />
    <connection from="t8" to="t3" type="NORMAL" sourcePosition="SOUTH" targetPosition="NORTH" />
    <connection from="t9" to="t1" type="NORMAL" sourcePosition="SOUTH" targetPosition="NORTH" />
    <connection from="t10" to="t9" type="NORMAL" sourcePosition="SOUTH" targetPosition="NORTH" />
  </flow>
</data>